## ChatBot Code Sample

안녕하세요 ChatBot 코드 샘플입니다. 다음사항을 고려해서 사용해주시면 감사하겠습니다.

### 🙈 고려사항
1. 일단 제가 React 랑 css 를 할 줄 몰라서 거의 LLM 이 짜준 코드를 기반으로 BaseCode 를 드립니다. 참고사항으로 사용하시면 좋을 것 같습니다.
2. 작동구조를 ReadME 에 작성해서 보내드릴테니 활용 하실 때 구조를 참고하시면서 작성하시면 좋을 것 같습니다.

---

### 🕛 코드 로직 및 사전세팅
해당 BaseCode 는 총 2개의 코드 샘플과 App.jsx 에 해당 코드를 사용하기 위한 선언부로 나뉘어 집니다.

0. 먼저 해당 레포를 clone 하여 두개 코드를 다운받아주시면 됩니다. 명령어는 다음과 같습니다.
```
git clone https://github.com/wlstjd6524/AiChatbotSample
```

1. 우선 App.jsx 상단분에 해당 코드를 import 해주세요. 해당 import 구문은 /components 디렉토리에 ChatbotWidget 파일을 사용하기 위해 경로를 로딩하는 역할을 합니다.
```
import ChatbotWidget from "./components/ChatbotWidget";
```

2. 그리고 App.jsx 에 </Routes> 다음 줄에 다음 문장을 선언해주세요. 해당 부분은 전역변수 구문으로 셋팅한 사항으로 앱의 모든화면에서 챗봇이 뜨게끔 하기 위해 전역변수로 셋팅을 진행하였습니다. 만약 필요한 부분의 앱 화면에서만 챗봇 아이콘이 뜨길 원하시면 지역변수 형태로 고안하여 원하는 지역에서만 선언하시는 것을 추천드립니다.
```
<ChatbotWidget />
```

3. 마지막으로 src/components 폴더에 Clone 으로 받아온 두개의 코드를 넣어주시면 됩니다.

---

### 🕐 코드설명
css 는 어디까지 디자인 부분이기 때문에 설명을 생략하겠습니다. LLM 이 주석을 달아줘서 해석에 용이하실 것 같긴 합니다.

```
const QUICK = ["실시간 스코어", "경기 결과", "경기 일정", "선수 기록", "팀 순위"];
```

해당 부분은 챗봇의 고정메뉴에 해당하는 변수입니다.
이미지의 빨간색 박스칸으로 쳐져있는 부분 입니다.

<img width="433" height="604" alt="Image" src="https://github.com/user-attachments/assets/7c8b3b10-7b96-4a3f-9e2b-98c99a0fcb95" />

```
const QUICK_RESPONSE = {
  "실시간 스코어": `⚾ 지금 경기 상황이에요!

5회말
기아 3 : 2 삼성
`,

  "경기 결과": `⚾ 경기 결과에요!

9회말 (경기 종료)
기아 6 : 4 삼성
`,

  "경기 일정": `📅 오늘의 경기 일정이에요!

18:30
기아 vs 삼성
(광주 기아챔피언스필드)
`,

  "선수 기록": `📊 주요 선수 기록이에요!

김도영
타율 0.328 / 홈런 18 / 타점 62
`,

  "팀 순위": `🏆 현재 팀 순위에요!

1위 기아 타이거즈
승률 0.612
`,
};
```

해당 부분은 QUICK 이라는 변수에 담긴 인덱스들에 대한 고정 대답값 입니다.
해당 메뉴를 누르면 다음으로 지정한 고정 대답값을 챗봇이 내뱉게 됩니다.

<img width="433" height="456" alt="Image" src="https://github.com/user-attachments/assets/7c419368-d34d-45f5-9002-d596f47f9de8" />

```
const FAQ_RULES = [
  {
    test: /(기아|KIA|기아타이거즈).*(색|색깔|컬러)|(?:색|색깔|컬러).*(기아|KIA|기아타이거즈)/i,
    reply:
      `🔴 기아 타이거즈의 상징색은 **빨간색**이에요!\n\n` +
      `이 빨간색은 팀과 팬의 **뜨거운 열정**을 상징하고,\n` +
      `과거 **해태 타이거즈 시절부터 이어진 정통성**과 아이덴티티를 계승하는 의미로\n` +
      `오랫동안 팀의 대표 컬러로 사용돼 왔어요.`,
  },

  // 예시로 한두 개 더 추가해둘 수도 있어
  {
    test: /(기아|KIA).*(연고지|홈|구장)|홈구장/i,
    reply: `🏟️ 기아 타이거즈의 홈구장은 **광주 기아챔피언스필드**예요!`,
  },

    {
    test: /(기아|KIA).*(양현종|현종)|양현종선수/i,
    reply: `기아타이거즈 양현종 선수는 1988년 3월 1일 생으로 광주광역시에서 태어난 선수에요! \n` +
    `2007년에 프로에 입단하여 2020년까지 기아타이거즈의 유명한 에이스 선발투수로 자리잡고 있었고\n` + 
    `2021년 MLB 텍사스 레인저스에 입단했다가 1년 후에 2022년 기아타이거즈로 돌아온\n` + 
    `기아타이거즈의 자부심이자 에이스인 선수 입니다!`,
  },
];
```

해당 부분은 이제 챗봇에서 메세지를 입력했을 때 내뱉는 값을 고정적으로 정의한건데
예를 들어 "기아 타이거즈의 상징적인 색깔이뭐야?" 또는 "기아타이거즈 색깔 뭐야" 라는 식으로 챗봇에게 메세지를 전달 했을 때
챗봇이 해당 메세지에 대한 응답값을 보내주는 로직입니다.

예시로 기아타이거즈 홈구장을 물어보거나, 기아타이거즈의 양현종 선수에 대한 정보를 물었을 때 챗봇이 어떤 대답을 내뱉는지 Test Sample 로 2가지만 더 추가하였습니다.

로직에 대한 간단한 설명은 test: 안에 들어간 단어를 정의해놓으면 정의해놓은 단어들이 포함된 문장을 사용자가 챗봇에게 질문을 던졌을 때 사용자가 챗봇에게 던진 질문에 단어들을 매핑하여 존재하는 단어가 test: 안에 들어가 있으면 해당 문장이 코드에 존재한다고 판단하여 reply 값을 뱉게 됩니다.

<img width="435" height="430" alt="Image" src="https://github.com/user-attachments/assets/ceb5cc21-c189-4932-a9f2-85d23b1573fb" /> <br>

<img width="434" height="451" alt="Image" src="https://github.com/user-attachments/assets/b72b605c-06a6-4d2c-bd25-44e71314dbca" /> <br>

<img width="440" height="434" alt="Image" src="https://github.com/user-attachments/assets/a201e86c-e7e1-4b65-a2ec-27648b0f5760" /> <br>

<img width="437" height="448" alt="Image" src="https://github.com/user-attachments/assets/0b01d098-da2b-45fd-bfa8-afecb2b59d03" /> <br>

해당 이미지는 test: 안에 들어가있지 않는 단어를 던져본 결과입니다. 단어가 매핑되지 않아서 구현하지 않은 로직이라 판단하고 다음 질문을 사용자에게 던집니다.

다음 부분부터는 참고하면 좋을 것 같은 코드부분만 설명하겠습니다.

```
  const getReply = (text) => {
    // 1) 퀵 버튼 우선
    if (QUICK_RESPONSE[text]) return QUICK_RESPONSE[text];

    // 2) 규칙 기반 매칭
    for (const rule of FAQ_RULES) {
      if (rule.test.test(text)) return rule.reply;
    }

    // 3) fallback
    return `🤖 아직은 데모라서 일부 질문만 답변할 수 있어요.\n\n예) "기아타이거즈 상징색", "홈구장", "경기 일정" 처럼 물어봐 주세요!`;
  };
```

getReply 라는 함수를 통해 text 인자값을 전달받게 되면 아래 1~3 로직이 if 문을 걸쳐 코드가 실행되어 집니다.

중요하게 볼 부분은 2번의 규칙 기반 매칭 과 3번의 fallback 값입니다.
규칙 기반 매칭은 FAQ_RULES 를 통해 우리가 전에 단어가 매핑되면 해당 문장을 뱉게끔 하는 시스템적 로직이 추가된 부분이고

3번의 fallback 은 단어가 매핑되지 않았을 때 해당 문장을 Return 합니다.

```
// 더미 응답 (패킷이 주고 받고가 되는지 전송 테스트용)
  const send = (text) => {
    const t = (text ?? input).trim();
    if (!t) return;

    // 입력창 비우기
    setInput("");

    // 유저 클릭 메시지
    setMessages((prev) => [
      ...prev,
      { role: "user", text: t },
    ]);

    // 인덱스별 챗봇 응답
    const reply = getReply(t);

    setTimeout(() => {
      setMessages((prev) => [
        ...prev,
        { role: "bot", text: reply },
      ]);
    }, 400); // 살짝 딜레이 → AI 느낌
  };
```

메세지가 주고 받기가 되는 것 처럼 보이게 하는 시스템 로직입니다.

주요 지점은 setInput(""); 으로 사용자가 채팅을 하나 전송하면 채팅창이 지워지면서 전송이 된 것 처럼 보이는 로직을 추가했고

나머지는 Send 와 Response 부분이여서 이해가 조금 어려우면 LLM 을 통해 메세지를 주고 받는 로직을 이해하시면 좋으실 것 같습니다.

---

### 🕑 착오하기 쉬운 점
제가 챗봇 시스템 구현을 제일 우순위로 두고 작업한 내용이라 다음 사항이 고려되어 있지 않습니다.

1. css 기반 깔끔한 디자인
2. 챗봇 위치

그래서 앱을 키셨을 때 챗봇이 어디있는지 헷갈리실 것 같아 이미지 파일을 첨부해드립니다.
이미지 처럼 우측 하단에 "도움" 이라는 버튼이 존재합니다.

<img width="1224" height="853" alt="Image" src="https://github.com/user-attachments/assets/4407adf1-1a1e-4fc8-bc5f-6467304d44eb" />

---

### 🕒 회의하면 좋을 내용
마지막으로 팀원간 회의하시면 좋을 것 같은 내용을 첨부해드립니다.

1. 우선 강사님께 챗봇에 대한 정확한 피드백을 받아보시는게 좋으실 것 같습니다. 제가 전해 듣기로는 강사님이 "챗봇 전용 API Key 를 발급받아 선언만 하면 그냥 쉽게 사용할 수 있다." 라고 말씀을 하신 것 같은데, 제 생각에는 API Key 만 발급받고 이처럼 챗봇 시스템을 사용하기에는 솔직히 무리가 있어 보입니다.
또 Send() , Response() 등등.. 서버간 통신에 대한 개념을 배우셨는지 아닌지에 대한 여부를 몰라서 일단 "챗봇기능이 동작하기" 를 포커스로 두고 제작한 부분이라 해당 고려사항을 모두 체크해보시고 팀 상황에 맞게 전략을 수정하시는게 좋을 것 같습니다.

2. 제가 전해들은 내용은 "챗봇에게 메세지를 보낼 때 정해진 질문에만 대답을 하고, 정해지지 않은 질문을 물어볼 때는 해당부분은 아직 구현 중 입니다! 라는 메세지를 내보내면서 7~8개? 의 질문에 대해서만 대답을 하게끔" 한다고 들었습니다. 그래서 제가 상위에 정해진 단어가 들어올 때만 텍스트를 매핑해서 챗봇이 대답을 던져주는 구조로 진행했었는데요, 이 구조를 유지하실지 아니면 다양한 대답에도 챗봇이 막힘없이 대답을 하는걸로 발전하실지 에 대한 여부를 정하시면 좋을 것 같습니다. 해당 2가지 부분에 대한 방향성도 밑에 기재해놓겠습니다.

2-1. 이 구조를 유지 할 경우
이 구조를 유지 할 경우는 BaseCode 에 따라 추가적으로 회의를 통해 나온 질문 Sample 5개만 잘 지정해서 추가만 해주시면 될 것 같습니다. 특히
```
test: /(기아|KIA|기아타이거즈).*(색|색깔|컬러)|(?:색|색깔|컬러).*(기아|KIA|기아타이거즈)/i,
```
이 test 안에 단어를 지정해주는 부분에 있어서 사용자가 질문할 때 사용할만한 단어를 모두 매핑해서 넣어주시면 문맥이 조금 달라지더라도 뜻만 통하게 되면 같은 대답을 뱉을 수 있게끔 구현하실 수 있으실 것 같습니다.

2-2. 챗봇이 다양한 대답에도 막힘없이 대답을 하는 걸 원하실 경우
이 때 API Key 를 할당받아 챗봇에 LLM Model 을 연결하시면 챗봇에서도 GPT 와 대화하듯이 사용하실 수 있을 것 같습니다.
이 부분을 채택하실 때 주의사항은 다음과 같습니다.

- 챗봇에 연결할 LLM Model 을 선택하기 (GPT 모델? 아니면 제미나이 모델?) => Answer) Open API(Chat GPT) 가 대표적입니다.
- API Key 를 사용할 떄 보통 무료 크레딧을 제공하지만 호출건수에 따라 크레딧을 사용하기에 테스트 하실 때 무료크레딧이 소진될 케이스가 존재합니다. 따라서 크레딧을 유료로 충전해야하는 경우가 발생하는데 해당 부분에 대해 고려하시는 게 좋을 것 같습니다. (p.s : 혹시 Open API 를 사용하신다고 하면 제가 옛날에 다른 프로젝트를 진행하면서 충전해놓은 5$ 상당의 크레딧이 존재하는 계정이 있습니다. 필요하시면 채운이한테 말씀해주시면 제가 크레딧이 존재하는 API Key 를 발급해서 드리겠습니다!)
- API Key 보안 문제 해결 & 만약 프로젝트 주최측에서 모델 사이즈가 정해질 경우 해당 LLM 모델을 넣었을 때의 파일 사이즈 문제해결과 경량화 전략방법

---

일단 제가 고안한 부분은 여기까지이고 추가적으로 생각나는게 있으면 채운이 통해서 메세지 전달해드리겠습니다!

궁금하신 점 이나 도움 필요하시면 말씀주세요

성공적인 프로젝트 되시길 기원합니다 :)
